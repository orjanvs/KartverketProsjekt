@using KartverketProsjekt.Models.ViewModels
@using Newtonsoft.Json

@model List<ListReportsViewModel>

<head>
    <link href="~/css/sortTableStyle.css" rel="stylesheet">
    <script src="https://kit.fontawesome.com/5eea027e19.js" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>

<div class="box">
    <i class="fa-solid fa-magnifying-glass"></i>
    <input type="text" id="searchTable" placeholder="Søk..." />
</div>



<body>
    <div class="container mt-3">
        <div class="filter-container">
            <div class="filter-box">
                <label for="filterStatusDropdown" class="me-2 text-dark">Filter by Status:</label>
                <select id="filterStatusDropdown" class="form-select">
                    <option value="All">Show All</option>
                    <option value="Pending">Pending</option>
                    <option value="In Progress">In Progress</option>
                    <option value="Completed">Completed</option>
                    <option value="Rejected">Rejected</option>
                </select>
            </div>

            <div class="filter-box">
                <label for="filterKartlagDropdown" class="me-2 text-dark">Filter by Kartlag:</label>
                <select id="filterKartlagDropdown" class="form-select">
                    <option value="All">Show All</option>
                    <option value="Turkart">Turkart</option>
                    <option value="Sjøkart">Sjøkart</option>
                    <option value="Fargekart">Fargekart</option>
                    <option value="Gråtonekart">Gråtonekart</option>
                </select>
            </div>
        </div>
    </div>
</body>


<div id="portexe-search-root">
    <div id="portexe-table-container">
        @if (Model != null && Model.Any())
        {
            <table class="table table-sortable" id="firstTableId">
                <thead>
                    <tr>
                        <th>Dato</th>
                        <th>Tittel</th>
                        <th>Fylke</th>
                        <th>Kommune</th>
                        <th>Kartlag</th>
                        <th>Vedlegg</th> <!-- Ny kolonne for vedleggsindikator -->
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="myTable">
                    @foreach (var mapReport in Model)
                    {
                        <tr>
                            <td>@mapReport.SubmissionDate</td>
                            <td>@mapReport.Title</td>
                            <td>@mapReport.County</td>
                            <td>@mapReport.Municipality</td>
                            <td>@mapReport.MapLayerType</td> <!-- NB! since the model is nested, you can do that to get a specific value -->
                            <td>

                                @if (mapReport.HasAttachments)
                                {
                                    <span class="badge bg-success">Vedlegg tilgjengelig</span> <!-- Indikator for vedlegg -->
                                }
                                else
                                {
                                    <span class="badge bg-secondary">Ingen vedlegg</span> <!-- Indikator for ingen vedlegg -->
                                }
                            </td>
                            <td>@mapReport.StatusDescription</td>

                            <td>
                                <a asp-area=""
                                   asp-controller="MapReport"
                                   asp-action="ViewReport"
                                   asp-route-id="@mapReport.MapReportId">
                                    <img src="~/images/green-arrow.svg" alt="Gå til" style="height: 40px;" />
                                </a>
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        }
        else
        {
            <p>Ingen innmeldinger funnet!</p>
        }


    </div>
</div>

<div>
    @if (ViewBag.PageNumber > 1)
    {
        <a asp-action="ListForm" asp-route-pageNumber="@(ViewBag.PageNumber - 1)" asp-route-pageSize="@ViewBag.PageSize">Forrige side</a>
    }
    @if (Model.Count == ViewBag.PageSize)
    {
        <a asp-action="ListForm" asp-route-pageNumber="@(ViewBag.PageNumber + 1)" asp-route-pageSize="@ViewBag.PageSize">Neste side</a>
    }
</div>

<script>var modelData = @Html.Raw(Json.Serialize(Model));</script>

<script src="~/js/site.js" defer></script>
